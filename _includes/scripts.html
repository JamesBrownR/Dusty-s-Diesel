<!---  javascr--->

<script>


     document.addEventListener('DOMContentLoaded', function () {
    // --- Header and Logo Size on Scroll ---
    const header = document.getElementById('header');
    const navContainer = document.getElementById('nav-container');
    const headerLogo = document.getElementById('header-logo');

    // Function to handle scroll
    function handleScroll() {
        const scrollPosition = window.scrollY;
        
        // If scrolled downm more than 50px, add 'scrolled' class
        if (scrollPosition > 50) {
            header.classList.add('scrolled');
            navContainer.classList.add('scrolled');
            headerLogo.classList.add('scrolled');
        } else {
            // At top, remove 'scrolled' class to make header/logo grow
            header.classList.remove('scrolled');
            navContainer.classList.remove('scrolled');
            headerLogo.classList.remove('scrolled');
        }
    }

    // Listen for scroll events
    window.addEventListener('scroll', handleScroll);
    
    // Call once on load to set initial state
    handleScroll();
});
    // --- Animate on Scroll (IntersectionObserver) ---
    const scrollElements = document.querySelectorAll('.animate-on-scroll');
    
    const observer = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
            if (entry.isIntersecting && window.matchMedia('(min-width: 768px)').matches) {
                entry.target.classList.add('is-visible');
                observer.unobserve(entry.target);
            }
        });
    }, {
        threshold: 0.1
    });

    scrollElements.forEach(el => {
        observer.observe(el);
    });
    
    // --- Mobile Menu Toggle ---
    const menuButton = document.getElementById('mobile-menu-button');
    const mobileMenu = document.getElementById('mobile-menu');
    const iconOpen = document.getElementById('menu-icon-open');
    const iconClose = document.getElementById('menu-icon-close');

    if (menuButton) {
        menuButton.addEventListener('click', () => {
            const isExpanded = menuButton.getAttribute('aria-expanded') === 'true';
            menuButton.setAttribute('aria-expanded', !isExpanded);
            mobileMenu.classList.toggle('hidden');
            iconOpen.classList.toggle('hidden');
            iconClose.classList.toggle('hidden');
        });
    }
    
    // --- Dynamic Gallery Population ---
    const galleryContainer = document.getElementById('gallery-grid');
    const galleryImages = [
        { src: '{{ site.baseurl }}/Custom-Diesel-Engine-Build.webp', alt: 'Custom diesel engine build' },
        { src: '{{ site.baseurl }}/Car-Lift.webp', alt: 'Truck on a service lift' },
        { src: '{{ site.baseurl }}/Performance-Tuning-Setup.webp', alt: 'Performance tuning setup' },
        { src: '{{ site.baseurl }}/Finished-Custom-Truck-Project.webp', alt: 'Finished custom truck project' },
        { src: '{{ site.baseurl }}/Suspension-Upgrade.webp', alt: 'Suspension upgrade' },
        { src: '{{ site.baseurl }}/Custom-Fabrication-Work.webp', alt: 'Custom fabrication work' },
        { src: '{{ site.baseurl }}/Turbo-Installation.webp', alt: 'Turbo installation' },
        { src: '{{ site.baseurl }}/Oil-Change.webp', alt: 'Diesel oil change service' },
    ];

    if (galleryContainer) {
        galleryImages.forEach(image => {
            const card = document.createElement('div');
            card.className = 'gallery-card relative group';
            
            card.innerHTML = `
                <div class="overflow-hidden">
                    <img src="${image.src}" alt="${image.alt}" class="w-full h-auto aspect-video object-cover transition-all duration-500 ease-in-out group-hover:scale-110 cursor-pointer">
                </div>
            `;
            galleryContainer.appendChild(card);
        });
    
        // Create lightbox modal
        const lightbox = document.createElement('div');
        lightbox.className = 'lightbox';
        lightbox.innerHTML = `
            <span class="lightbox-close">&times;</span>
            <img src="" alt="">
        `;
        document.body.appendChild(lightbox);

        const lightboxImg = lightbox.querySelector('img');
        const lightboxClose = lightbox.querySelector('.lightbox-close');

        // Add click event to all gallery images
        galleryContainer.addEventListener('click', (e) => {
            if (e.target.tagName === 'IMG') {
                lightbox.classList.add('active');
                lightboxImg.src = e.target.src;
                lightboxImg.alt = e.target.alt;
                document.body.style.overflow = 'hidden';
            }
        });

        // Close lightbox
        lightboxClose.addEventListener('click', () => {
            lightbox.classList.remove('active');
            document.body.style.overflow = 'auto';
        });

        // Close on background click
        lightbox.addEventListener('click', (e) => {
            if (e.target === lightbox) {
                lightbox.classList.remove('active');
                document.body.style.overflow = 'auto';
            }
        });

        // Close on Escape key
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape' && lightbox.classList.contains('active')) {
                lightbox.classList.remove('active');
                document.body.style.overflow = 'auto';
            }
        });
    }
                          
    // --- Dynamic Review Population ---
    const reviewsContainer = document.getElementById('reviews-container');
    const showMoreBtn = document.getElementById('show-more-reviews');
    const showLessBtn = document.getElementById('show-less-reviews');
    
    const reviews = [
        {
            "name": "Ramiro Parga",
            "rating": 5,
            "body": "Dusty, Brad and Miguel are very professional mechanics, who took us in when they had other's and treaded us like family right away and will definitely be coming back for more upgrades very much recommended thank you üôè y'all are BLESSINGS to us guys from San Antonio, TX very reasonable much appreciated guys."
        },
        {
            "name": "Juan Ledezma",
            "rating": 5,
            "body": "Great work awesome people appreciate their work and time to get us back on the road, definitely letting them do any work on my truck will be coming back"
        },
        {
            "name": "hector lazo",
            "rating": 5,
            "body": "My driver ran out of diesel. I called them and they went out of their way to help us out. We are a trucking company just passing through, but if we were from the area, they would be out go to guys. Thank you Brad & Dusty for helping us out. Best of luck to you guys!"
        },
        {
            "name": "Winona Parsons",
            "rating": 5,
            "body": "Well of course this is the best diesel shop ever!! The staff is very knowledgeable and courteous! Stop by and ask about the new Dynojet!!"
        },
        {
            "name": "Darrell Collins",
            "rating": 5,
            "body": "Brad and Miguel are very knowledgeable and professional. Their shop deleted the def and EGR systems in 2021. The truck has ran great since then. I had to get the transmission rebuilt in June 2023 and the shop that did the rebuild could not ‚Ä¶ More"
        },
        {
            "name": "Ashley Giles",
            "rating": 5,
            "body": "I was in town for a short period of time visiting family and my diesel truck was having issues. Rusty got me in the same day I called and the truck was fixed the very next day! He took the time to show me what he thought the issue was, what ‚Ä¶ More"
        },
        {
            "name": "Kyle Bebber",
            "rating": 5,
            "body": "Have had a few things done here on a couple vehicles. Very honest and knowledgeable. Would recommend to anyone who needs repairs or tuning."
        },
        {
            "name": "Daniel S.",
            "rating": 5,
            "body": "Dusty is fair priced and does high quality work!! This is the place to go when you want high performance install, at a affordable price. Dusty is the man !!!!"
        },
        {
            "name": "Betty Hopper",
            "rating": 5,
            "body": "Couldn't ask for more professional and helpful folks!! Outstanding service, above & beyond anything we expected! We would certainly highly recommend them!!"
        },
        {
            "name": "Walter Bannon",
            "rating": 5,
            "body": "Very knowledgeable shop! They will get you taken care of!"
        }
    ];
    
    const initialReviewCount = 4;
    
    // Helper function to render star icons
    function renderStars(rating) {
        let starsHTML = '';
        const fullStars = Math.floor(rating);
        const halfStar = rating % 1 !== 0;
        
        for(let i = 0; i < fullStars; i++) {
            starsHTML += '<i class="fa-solid fa-star text-yellow-400"></i>';
        }
        if (halfStar) {
            starsHTML += '<i class="fa-solid fa-star-half-stroke text-yellow-400"></i>';
        }
        const emptyStars = 5 - Math.ceil(rating);
        for(let i = 0; i < emptyStars; i++) {
            starsHTML += '<i class="fa-regular fa-star text-yellow-400"></i>';
        }
        return starsHTML;
    }
    
    // Function to render reviews
    function renderReviews(count) {
        if (!reviewsContainer) return;
        
        reviewsContainer.innerHTML = '';
        const reviewsToShow = reviews.slice(0, count);
        
        reviewsToShow.forEach(review => {
            const card = document.createElement('div');
            card.className = 'review-card p-8';
            
            card.innerHTML = `
                <div class="flex items-center mb-4">
                    <div class="w-12 h-12 rounded-full bg-brand-red flex items-center justify-center text-white text-xl font-bold">
                        ${review.name.charAt(0)}
                    </div>
                    <div class="ml-4">
                        <h4 class="text-lg font-bold text-white">${review.name}</h4>
                        <div class="flex items-center text-sm text-gray-400">
                            ${renderStars(review.rating)}
                            <span class="ml-2">${review.rating} Stars</span>
                        </div>
                    </div>
                </div>
                <p class="text-gray-300 italic">"${review.body}"</p>
            `;
            reviewsContainer.appendChild(card);
        });
    }

    // Initial render - show only 4 reviews
    renderReviews(initialReviewCount);
    
    // Show More button
    if (showMoreBtn) {
        showMoreBtn.addEventListener('click', () => {
            renderReviews(reviews.length);
            showMoreBtn.classList.add('hidden');
            showLessBtn.classList.remove('hidden');
        });
    }
    
    // Show Less button
    if (showLessBtn) {
        showLessBtn.addEventListener('click', () => {
            renderReviews(initialReviewCount);
            showLessBtn.classList.add('hidden');
            showMoreBtn.classList.remove('hidden');
            // Scroll back to reviews section
            const reviewsSection = document.getElementById('reviews');
            if (reviewsSection) {
                reviewsSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
            }
        });
    }
});
</script>
